!function(a){function b(a){var b=e,c=b.biDivideByRadixPower(a,this.k-1),d=b.biMultiply(c,this.mu),f=b.biDivideByRadixPower(d,this.k+1),g=b.biModuloByRadixPower(a,this.k+1),h=b.biMultiply(f,this.modulus),i=b.biModuloByRadixPower(h,this.k+1),j=b.biSubtract(g,i);j.isNeg&&(j=b.biAdd(j,this.bkplus1));for(var k=b.biCompare(j,this.modulus)>=0;k;)j=b.biSubtract(j,this.modulus),k=b.biCompare(j,this.modulus)>=0;return j}function c(a,b){var c=e.biMultiply(a,b);return this.modulo(c)}function d(a,b){var c=new l;c.digits[0]=1;for(var d=a,f=b;;){if(0!=(1&f.digits[0])&&(c=this.multiplyMod(c,d)),f=e.biShiftRight(f,1),0==f.digits[0]&&0==e.biHighIndex(f))break;d=this.multiplyMod(d,d)}return c}if(void 0===a.RSAUtils)var e=a.RSAUtils={};var f,g,h,k,l=a.BigInt=function(a){this.digits="boolean"==typeof a&&1==a?null:g.slice(0),this.isNeg=!1};e.setMaxDigits=function(a){f=a,g=new Array(f);for(var b=0;b<g.length;b++)g[b]=0;h=new l,k=new l,k.digits[0]=1},e.setMaxDigits(20);e.biFromNumber=function(a){var b=new l;b.isNeg=a<0,a=Math.abs(a);for(var c=0;a>0;)b.digits[c++]=65535&a,a=Math.floor(a/65536);return b};var m=e.biFromNumber(1e15);e.biFromDecimal=function(a){for(var b,c="-"==a.charAt(0),d=c?1:0;d<a.length&&"0"==a.charAt(d);)++d;if(d==a.length)b=new l;else{var f=a.length-d,g=f%15;for(0==g&&(g=15),b=e.biFromNumber(Number(a.substr(d,g))),d+=g;d<a.length;)b=e.biAdd(e.biMultiply(b,m),e.biFromNumber(Number(a.substr(d,15)))),d+=15;b.isNeg=c}return b},e.biCopy=function(a){var b=new l(!0);return b.digits=a.digits.slice(0),b.isNeg=a.isNeg,b},e.reverseStr=function(a){for(var b="",c=a.length-1;c>-1;--c)b+=a.charAt(c);return b};var n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];e.biToString=function(a,b){var c=new l;c.digits[0]=b;for(var d=e.biDivideModulo(a,c),f=n[d[1].digits[0]];1==e.biCompare(d[0],h);)d=e.biDivideModulo(d[0],c),digit=d[1].digits[0],f+=n[d[1].digits[0]];return(a.isNeg?"-":"")+e.reverseStr(f)},e.biToDecimal=function(a){var b=new l;b.digits[0]=10;for(var c=e.biDivideModulo(a,b),d=String(c[1].digits[0]);1==e.biCompare(c[0],h);)c=e.biDivideModulo(c[0],b),d+=String(c[1].digits[0]);return(a.isNeg?"-":"")+e.reverseStr(d)};var o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];e.digitToHex=function(a){var b="";for(i=0;i<4;++i)b+=o[15&a],a>>>=4;return e.reverseStr(b)},e.biToHex=function(a){for(var b="",c=(e.biHighIndex(a),e.biHighIndex(a));c>-1;--c)b+=e.digitToHex(a.digits[c]);return b},e.charToHex=function(a){return a>=48&&a<=57?a-48:a>=65&&a<=90?10+a-65:a>=97&&a<=122?10+a-97:0},e.hexToDigit=function(a){for(var b=0,c=Math.min(a.length,4),d=0;d<c;++d)b<<=4,b|=e.charToHex(a.charCodeAt(d));return b},e.biFromHex=function(a){for(var b=new l,c=a.length,d=c,f=0;d>0;d-=4,++f)b.digits[f]=e.hexToDigit(a.substr(Math.max(d-4,0),Math.min(d,4)));return b},e.biFromString=function(a,b){var c="-"==a.charAt(0),d=c?1:0,f=new l,g=new l;g.digits[0]=1;for(var h=a.length-1;h>=d;h--){var i=a.charCodeAt(h),j=e.charToHex(i),k=e.biMultiplyDigit(g,j);f=e.biAdd(f,k),g=e.biMultiplyDigit(g,b)}return f.isNeg=c,f},e.biDump=function(a){return(a.isNeg?"-":"")+a.digits.join(" ")},e.biAdd=function(a,b){var c;if(a.isNeg!=b.isNeg)b.isNeg=!b.isNeg,c=e.biSubtract(a,b),b.isNeg=!b.isNeg;else{c=new l;for(var d,f=0,g=0;g<a.digits.length;++g)d=a.digits[g]+b.digits[g]+f,c.digits[g]=d%65536,f=Number(d>=65536);c.isNeg=a.isNeg}return c},e.biSubtract=function(a,b){var c;if(a.isNeg!=b.isNeg)b.isNeg=!b.isNeg,c=e.biAdd(a,b),b.isNeg=!b.isNeg;else{c=new l;var d,f;f=0;for(var g=0;g<a.digits.length;++g)d=a.digits[g]-b.digits[g]+f,c.digits[g]=d%65536,c.digits[g]<0&&(c.digits[g]+=65536),f=0-Number(d<0);if(f==-1){f=0;for(var g=0;g<a.digits.length;++g)d=0-c.digits[g]+f,c.digits[g]=d%65536,c.digits[g]<0&&(c.digits[g]+=65536),f=0-Number(d<0);c.isNeg=!a.isNeg}else c.isNeg=a.isNeg}return c},e.biHighIndex=function(a){for(var b=a.digits.length-1;b>0&&0==a.digits[b];)--b;return b},e.biNumBits=function(a){var b,c=e.biHighIndex(a),d=a.digits[c],f=16*(c+1);for(b=f;b>f-16&&0==(32768&d);--b)d<<=1;return b},e.biMultiply=function(a,b){for(var c,d,f,g=new l,h=e.biHighIndex(a),i=e.biHighIndex(b),k=0;k<=i;++k){for(c=0,f=k,j=0;j<=h;++j,++f)d=g.digits[f]+a.digits[j]*b.digits[k]+c,g.digits[f]=65535&d,c=d>>>16;g.digits[k+h+1]=c}return g.isNeg=a.isNeg!=b.isNeg,g},e.biMultiplyDigit=function(a,b){var c,d,f;result=new l,c=e.biHighIndex(a),d=0;for(var g=0;g<=c;++g)f=result.digits[g]+a.digits[g]*b+d,result.digits[g]=65535&f,d=f>>>16;return result.digits[1+c]=d,result},e.arrayCopy=function(a,b,c,d,e){for(var f=Math.min(b+e,a.length),g=b,h=d;g<f;++g,++h)c[h]=a[g]};var p=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];e.biShiftLeft=function(a,b){var c=Math.floor(b/16),d=new l;e.arrayCopy(a.digits,0,d.digits,c,d.digits.length-c);for(var f=b%16,g=16-f,h=d.digits.length-1,i=h-1;h>0;--h,--i)d.digits[h]=d.digits[h]<<f&65535|(d.digits[i]&p[f])>>>g;return d.digits[0]=d.digits[h]<<f&65535,d.isNeg=a.isNeg,d};var q=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.biShiftRight=function(a,b){var c=Math.floor(b/16),d=new l;e.arrayCopy(a.digits,c,d.digits,0,a.digits.length-c);for(var f=b%16,g=16-f,h=0,i=h+1;h<d.digits.length-1;++h,++i)d.digits[h]=d.digits[h]>>>f|(d.digits[i]&q[f])<<g;return d.digits[d.digits.length-1]>>>=f,d.isNeg=a.isNeg,d},e.biMultiplyByRadixPower=function(a,b){var c=new l;return e.arrayCopy(a.digits,0,c.digits,b,c.digits.length-b),c},e.biDivideByRadixPower=function(a,b){var c=new l;return e.arrayCopy(a.digits,b,c.digits,0,c.digits.length-b),c},e.biModuloByRadixPower=function(a,b){var c=new l;return e.arrayCopy(a.digits,0,c.digits,0,b),c},e.biCompare=function(a,b){if(a.isNeg!=b.isNeg)return 1-2*Number(a.isNeg);for(var c=a.digits.length-1;c>=0;--c)if(a.digits[c]!=b.digits[c])return a.isNeg?1-2*Number(a.digits[c]>b.digits[c]):1-2*Number(a.digits[c]<b.digits[c]);return 0},e.biDivideModulo=function(a,b){var c,d,f=e.biNumBits(a),g=e.biNumBits(b),h=b.isNeg;if(f<g)return a.isNeg?(c=e.biCopy(k),c.isNeg=!b.isNeg,a.isNeg=!1,b.isNeg=!1,d=biSubtract(b,a),a.isNeg=!0,b.isNeg=h):(c=new l,d=e.biCopy(a)),[c,d];c=new l,d=a;for(var i=Math.ceil(g/16)-1,j=0;b.digits[i]<32768;)b=e.biShiftLeft(b,1),++j,++g,i=Math.ceil(g/16)-1;d=e.biShiftLeft(d,j),f+=j;for(var m=Math.ceil(f/16)-1,n=e.biMultiplyByRadixPower(b,m-i);e.biCompare(d,n)!=-1;)++c.digits[m-i],d=e.biSubtract(d,n);for(var o=m;o>i;--o){var p=o>=d.digits.length?0:d.digits[o],q=o-1>=d.digits.length?0:d.digits[o-1],r=o-2>=d.digits.length?0:d.digits[o-2],s=i>=b.digits.length?0:b.digits[i],t=i-1>=b.digits.length?0:b.digits[i-1];c.digits[o-i-1]=p==s?65535:Math.floor((65536*p+q)/s);for(var u=c.digits[o-i-1]*(65536*s+t),v=4294967296*p+(65536*q+r);u>v;)--c.digits[o-i-1],u=c.digits[o-i-1]*(65536*s|t),v=65536*p*65536+(65536*q+r);n=e.biMultiplyByRadixPower(b,o-i-1),d=e.biSubtract(d,e.biMultiplyDigit(n,c.digits[o-i-1])),d.isNeg&&(d=e.biAdd(d,n),--c.digits[o-i-1])}return d=e.biShiftRight(d,j),c.isNeg=a.isNeg!=h,a.isNeg&&(c=h?e.biAdd(c,k):e.biSubtract(c,k),b=e.biShiftRight(b,j),d=e.biSubtract(b,d)),0==d.digits[0]&&0==e.biHighIndex(d)&&(d.isNeg=!1),[c,d]},e.biDivide=function(a,b){return e.biDivideModulo(a,b)[0]},e.biModulo=function(a,b){return e.biDivideModulo(a,b)[1]},e.biMultiplyMod=function(a,b,c){return e.biModulo(e.biMultiply(a,b),c)},e.biPow=function(a,b){for(var c=k,d=a;;){if(0!=(1&b)&&(c=e.biMultiply(c,d)),0==(b>>=1))break;d=e.biMultiply(d,d)}return c},e.biPowMod=function(a,b,c){for(var d=k,f=a,g=b;;){if(0!=(1&g.digits[0])&&(d=e.biMultiplyMod(d,f,c)),g=e.biShiftRight(g,1),0==g.digits[0]&&0==e.biHighIndex(g))break;f=e.biMultiplyMod(f,f,c)}return d},a.BarrettMu=function(a){this.modulus=e.biCopy(a),this.k=e.biHighIndex(this.modulus)+1;var f=new l;f.digits[2*this.k]=1,this.mu=e.biDivide(f,this.modulus),this.bkplus1=new l,this.bkplus1.digits[this.k+1]=1,this.modulo=b,this.multiplyMod=c,this.powMod=d};var r=function(b,c,d){var f=e;this.e=f.biFromHex(b),this.d=f.biFromHex(c),this.m=f.biFromHex(d),this.chunkSize=2*f.biHighIndex(this.m),this.radix=16,this.barrett=new a.BarrettMu(this.m)};e.getKeyPair=function(a,b,c){return new r(a,b,c)},void 0===a.twoDigit&&(a.twoDigit=function(a){return(a<10?"0":"")+String(a)}),e.encryptedString=function(a,b){for(var c=[],d=b.length,f=0;f<d;)c[f]=b.charCodeAt(f),f++;for(;c.length%a.chunkSize!=0;)c[f++]=0;var g,h,i,j=c.length,k="";for(f=0;f<j;f+=a.chunkSize){for(i=new l,g=0,h=f;h<f+a.chunkSize;++g)i.digits[g]=c[h++],i.digits[g]+=c[h++]<<8;var m=a.barrett.powMod(i,a.e);k+=(16==a.radix?e.biToHex(m):e.biToString(m,a.radix))+" "}return k.substring(0,k.length-1)},e.decryptedString=function(a,b){var c,d,f,g=b.split(" "),h="";for(c=0;c<g.length;++c){var i;for(i=16==a.radix?e.biFromHex(g[c]):e.biFromString(g[c],a.radix),f=a.barrett.powMod(i,a.d),d=0;d<=e.biHighIndex(f);++d)h+=String.fromCharCode(255&f.digits[d],f.digits[d]>>8)}return 0==h.charCodeAt(h.length-1)&&(h=h.substring(0,h.length-1)),h},e.setMaxDigits(130)}(window);